<%- include ('../partials/header.ejs', {username: username, role: role}) %>
<div class="container">
    <div class="jumbotron">
        <!-- Error Message -->
        <%- include ('../partials/error_message.ejs') %>
        <form name="adminUserForm" id="adminUserForm" class="contact-form row" action="/admin/users/add_user"
            method="post">
            <div class="form-field col-lg-6 mb-2 pr-4">
                <label for="inputName">Name&nbsp;&nbsp;&nbsp;</label>
                <input type="text" class="form-control" id="inputName" name="inputName" maxlength="70" 
                    value="<%= typeof inputName != 'undefined' ? inputName : ''  %>" onchange="setSuccess(event.target)">
                <small>Error Message</small>
            </div>
            <div class="form-field col-lg-6 mb-2 pl-4">
                <label for="inputUsername">Username</label>
                <input type="text" class="form-control" id="inputUsername" name="inputUsername" maxlength="70" pattern="[@][A-Za-z0-9_]{2,70}" placeholder="@user_name" 
                oninvalid="this.setCustomValidity('Use @ at start, then only letters, digits and underscore are allowed in suceeding')" onvalid="this.setCustomValidity('')"
                value="<%= typeof inputUsername != 'undefined' ? inputUsername : ''  %>" onchange="setSuccess(event.target)">
                <small>Error Message</small>
            </div>
            <div class="form-field col-lg-6 mb-2 pr-4">
                <label for="inputPassword">Password</label>
                <input type="password" class="form-control" id="inputPassword" name="inputPassword" maxlength="60"
                    value="<%= typeof inputPassword != 'undefined' ? inputPassword : ''  %>" onchange="setSuccess(event.target)">
                <small>Error Message</small>
            </div>
            <div class="form-field col-lg-6 mb-2 pl-4">
                <label for="inputEmail">Email Address</label>
                <input type="text" class="form-control" id="inputEmail" name="inputEmail" placeholder="email@gmail.com"
                    maxlength="50" value="<%= typeof inputEmail != 'undefined' ? inputEmail : ''  %>" onchange="setSuccess(event.target)">
                <small>Error Message</small>
            </div>
            <div class="form-field col-lg-6 mb-2 pr-4">
                <label for="inputContact">Contact No.</label>
                <input type="tel" class="form-control" id="inputContact" name="inputContact" placeholder="09887982143"
                    maxlength="11" onkeypress="return isNumberKey(event)"
                    value="<%= typeof inputContact != 'undefined' ? inputContact : ''  %>" onchange="setSuccess(event.target)">
                <small>Error Message</small>
            </div>
            <div class="form-field col-lg-6 mb-2 pl-4">
                <label for="inputBirthdate">Birthdate</label>
                <input type="date" class="form-control" id="inputBirthdate" name="inputBirthdate"
                    placeholder="DD/MM/YYYY" value="<%= typeof inputBirthdate != 'undefined' ? inputBirthdate : ''  %>" onchange="setSuccess(event.target)">
                <small>Error Message</small>
            </div>
            <div class="form-field col-lg-6 mb-2 pr-4">
                <label for="inputAddress">Address</label>
                <textarea class="form-control m-0" id="inputAddress" name="inputAddress"
                    rows="2" onchange="setSuccess(event.target)"><%= typeof inputAddress != 'undefined' ? inputAddress : ''  %></textarea>
                <small>Error Message</small>
            </div>
            <div class="form-field col-lg-6 mb-4 pl-4">
                <label class="mr-3">Role</label>
                <% if (typeof inputRole != 'undefined') { %>
                    <% if ( inputRole == 'ADMIN') { %>
                        <input type="radio" id="admin" name="inputRole" value="ADMIN" checked>
                        <label class="mr-2" for="admin">Admin</label>
                        <input type="radio" id="editor" name="inputRole" value="EDITOR">
                        <label class="mr-2" for="editor">Editor</label>
                    <% } else { %>
                        <input type="radio" id="admin" name="inputRole" value="ADMIN">
                        <label class="mr-2" for="admin">Admin</label>
                        <input type="radio" id="editor" name="inputRole" value="EDITOR" checked>
                        <label class="mr-2" for="editor">Editor</label>
                    <% } %>
                <% } else { %>
                    <input type="radio" id="admin" name="inputRole" value="ADMIN">
                    <label class="mr-2" for="admin">Admin</label>
                    <input type="radio" id="editor" name="inputRole" value="EDITOR" checked>
                    <label class="mr-2" for="editor">Editor</label>
                <% } %> 
            </div>
            <div class="row ml-auto mr-3">
                <a class="btn btn-secondary btn-lg mr-3" href="/admin/users">Cancel</a>
                <button type="submit" onclick="return userValidation()" class="btn btn-primary btn-lg">Add User</button>
            </div>
        </form>
    </div>
</div>

<%- include ('../partials/footer.ejs') %>
<script src="/js/add_user.js"></script>
<script>
    $(function(){
    let today = new Date();
    let month = today.getMonth() + 1;
    let day = today.getDate();
    let year = today.getFullYear()-18;
    if(month < 10)
        month = '0' + month.toString();
    if(day < 10)
        day = '0' + day.toString();
    
    var maxDate = year + '-' + month + '-' + day;
    $('#inputBirthdate').attr('max', maxDate);
});
</script>